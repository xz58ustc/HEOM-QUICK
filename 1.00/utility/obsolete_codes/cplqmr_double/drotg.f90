      subroutine drotg(da,db,c,s) 
!                                                                       
!     construct givens plane rotation.                                  
!     jack dongarra, linpack, 3/11/78.                                  
!                    modified 9/27/86.                                  
!                                                                       
      double precision da,db,c,s,roe,scale,r,z 
!                                                                       
      roe = db 
      if( dabs(da) .gt. dabs(db) ) roe = da 
      scale = dabs(da) + dabs(db) 
      if( scale .ne. 0.0d0 ) go to 10 
         c = 1.0d0 
         s = 0.0d0 
         r = 0.0d0 
         go to 20 
   10 r = scale*dsqrt((da/scale)**2 + (db/scale)**2) 
      r = dsign(1.0d0,roe)*r 
      c = da/r 
      s = db/r 
   20 z = s 
      if( dabs(c) .gt. 0.0d0 .and. dabs(c) .le. s ) z = 1.0d0/c 
      da = r 
      db = z 
      return 
      END                                           
